use_df <- subset(master_df, psych_date >= "2017-08-15")
use_df <- subset(use_df, age_at_testing >= 8 & age_at_testing < 13)
use_df <- subset(use_df, aud_dis == 0)
use_df <- subset(use_df, wasi_fs2 >= 70)
use_df <- subset(use_df, !(subject_id %in% c("IB701","KB630","IB706","IB263","HB656","HB213","IB319","HB742","GB727")))
use_df <- mutate(use_df, is_dyslexic = ifelse( (wj_brs <= 85 & twre_index <= 85) | subject_id == "HB664","dyslexic",
ifelse((wj_brs >= 100 & twre_index >= 100) , "above average", "below average")))
library(stringr)
library(dplyr)
library(lme4)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
endpts_sasha <- use_df %>%
filter(str_detect(stimulus, "Sa")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition ) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Sha", "1",
ifelse(str_detect(stimulus,"7") & selection == "Sa", "1",
"0")),
continuum = "/ʃa/-/sa/")
endpts <- rbind(endpts_bada, endpts_sasha)
filepath = '/home/eobrien/bde/Projects/Speech_contrasts/'
repos_df <- read.csv( paste0(filepath, "RDRPRepository_DATA_2018-02-12_1433.csv"))
registry_df<- read.csv( paste0(filepath, "RDRPRegistry_DATA_2018-01-02_1138.csv"))
colnames(repos_df)[1] <- "record_id"
master_df <- merge(repos_df, registry_df, by = "record_id")
subj_record_id <- master_df %>% filter(sid.x %in% subj_id_list) %>% select(record_id)
subject_df <- master_df %>% filter(record_id %in% subj_record_id$record_id)
reading_df <- subject_df[c("record_id","dys_dx","adhd_dx","brain_injury","aud_dis","wj_brs","twre_index","wasi_fs2")]
reading_df <- reading_df[!duplicated(reading_df),]
reading_df <- reading_df %>% group_by(record_id) %>% summarise_all(funs(mean(as.numeric(.), na.rm=TRUE)))
bio_df <- subject_df[c("sid.x","dob","record_id")]
bio_df[bio_df==""] <- NA
bio_df <- na.omit(bio_df)
timestamp = numeric(length(subj_id_list))
for (i in 1:length(subj_id_list)){
con <- file(paste0(filepath, "Results/Raw/", subj_id_list[i], "_categorization_Ba_Da_1.txt"))
timestamp[i] <- readLines(con,n=1)
close(con)
}
timestamp_df = data.frame(psych_date = timestamp,
sid.x = subj_id_list)
vars <- colsplit(timestamp_df$psych_date, ",", c("date","time"))
timestamp_df$psych_date <- vars$date
bio_df <- merge(bio_df, timestamp_df)
bio_df$dob <- as.POSIXct(bio_df$dob, format="%Y-%m-%d")
bio_df$psych_date <- as.POSIXct(bio_df$psych_date, format="%Y-%m-%d")
bio_df$age_at_testing <- as.numeric(difftime(bio_df$psych_date,bio_df$dob,units="weeks")/52.25)
colnames(bio_df)[1] <- "subject_id"
master_df <- merge(bio_df, ba_da_pm)
master_df <- merge(master_df, reading_df)
use_df <- subset(master_df, psych_date >= "2017-08-15")
use_df <- subset(use_df, age_at_testing >= 8 & age_at_testing < 13)
use_df <- subset(use_df, aud_dis == 0)
use_df <- subset(use_df, wasi_fs2 >= 70)
use_df <- subset(use_df, !(subject_id %in% c("IB701","KB630","IB706","IB263","HB656","HB213","IB319","HB742","GB727")))
use_df <- mutate(use_df, is_dyslexic = ifelse( (wj_brs <= 85 & twre_index <= 85) | subject_id == "HB664","dyslexic",
ifelse((wj_brs >= 100 & twre_index >= 100) , "above average", "below average")))
library(stringr)
library(dplyr)
library(lme4)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(mean(selection)),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
warnings()
View(use_df)
View(endpts_bada)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
class(use_df$selection)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
endpts_sasha <- use_df %>%
filter(str_detect(stimulus, "Sa")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition ) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Sha", "1",
ifelse(str_detect(stimulus,"7") & selection == "Sa", "1",
"0")),
continuum = "/ʃa/-/sa/")
endpts <- rbind(endpts_bada, endpts_sasha)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
library(dplyr)
library(lme4)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
endpts_sasha <- use_df %>%
filter(str_detect(stimulus, "Sa")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition ) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Sha", "1",
ifelse(str_detect(stimulus,"7") & selection == "Sa", "1",
"0")),
continuum = "/ʃa/-/sa/")
endpts <- rbind(endpts_bada, endpts_sasha)
endpts = transform(endpts,
trial.rank = ave(trial, run_id,
FUN = function(x) rank(x, ties.method = "first")))
endpts <- rbind(endpts_bada, endpts_sasha)
View(endpts_sasha)
View(endpts_bada)
View(endpts_sasha)
endpts = endpts_sasha
wj_scores_df <- use_df %>% group_by(subject_id) %>% summarise(wj_brs = unique(wj_brs),
age = unique(age_at_testing),
adhd_dx = unique(adhd_dx))
endpts <- merge(endpts, wj_scores_df)
endpts$correct <- as.numeric(endpts$correct)
endpts$Condition <- factor(endpts$Condition, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$Condition) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$type), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$contrast), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age, scale=FALSE)
endpts$trial <- scale(endpts$trial, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*Condition*continuum + adhd_dx + age +  (1|subject_id), endpts)
summary(lmfit)
coefs <- data.frame(coef(summary(lmfit)))
df.KR <- get_ddf_Lb(lmfit, fixef(lmfit))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
rm(list = ls())
setwd("../Speech_contrasts_public")
getwd()
setwd("../../Speech_contrasts_public")
l
l
library(ggplot2)
library(dplyr)
library(stringr)
library(lme4)
library(dplyr)
library(pbkrtest)
use_df <- read.csv("../cleaned_data.csv")
use_df <- read.csv("./cleaned_data.csv")
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts = transform(endpts,
trial.rank = ave(trial, run_id,
FUN = function(x) rank(x, ties.method = "first")))
wj_scores_df <- use_df %>% group_by(subject_id) %>% summarise(wj_brs = unique(wj_brs),
age = unique(mean(age_at_testing)),
adhd_dx = unique(adhd_dx))
endpts <- merge(endpts, wj_scores_df)
endpts$correct <- as.numeric(endpts$response)
View(endpts)
a <- subset(enpts, subject_id == "GB208" & continuum != "/ba/-/da/")
a <- subset(endpts, subject_id == "GB208" & continuum != "/ba/-/da/")
View(a)
endpts$correct <- mutate(endpts, correct = ifelse(continuum == "/ba/-/da/" & step == 1 & response == 0, "1",
ifelse(continuum == "/ba/-/da/" & step == 7 & response == 1, "1",
ifelse(continuum == "/ʃa/-/sa/" & step == 1 & response == 0, "1",
ifelse(continuum == "/ʃa/-/sa/" & step == 7 & response == 1, "1",
"0")))))
endpts = transform(endpts,
trial.rank = ave(trial, run_id,
FUN = function(x) rank(x, ties.method = "first")))
wj_scores_df <- use_df %>% group_by(subject_id) %>% summarise(wj_brs = unique(wj_brs),
age = unique(mean(age_at_testing)),
adhd_dx = unique(adhd_dx))
endpts <- merge(endpts, wj_scores_df)
endpts$correct <- as.numeric(endpts$response)
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$type), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$contrast), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
summary(lmfit)
coefs <- data.frame(coef(summary(lmfit)))
df.KR <- get_ddf_Lb(lmfit, fixef(lmfit))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
endpts = transform(endpts,
trial.rank = ave(trial, run_id,
FUN = function(x) rank(x, ties.method = "first")))
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
wj_scores_df <- use_df %>% group_by(subject_id) %>% summarise(wj_brs = unique(wj_brs),
age = unique(mean(age_at_testing)),
adhd_dx = unique(adhd_dx))
View(endpts)
endpts <- merge(endpts, wj_scores_df)
endpts$correct <- as.numeric(endpts$response)
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
wj_scores_df <- use_df %>% group_by(subject_id) %>% summarise(wj_brs = unique(wj_brs),
age = unique(mean(age_at_testing)),
adhd_dx = unique(adhd_dx))
endpts <- merge(endpts, wj_scores_df)
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$type), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$contrast), "/ʃa/-/sa/"))
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$type), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$contrast), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
summary(lmfit)
View(endpts)
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
use_df <- read.csv("./cleaned_data.csv")
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
wj_scores_df <- use_df %>% group_by(subject_id) %>% summarise(wj_brs = unique(wj_brs),
age = unique(mean(age_at_testing)),
adhd_dx = unique(adhd_dx))
endpts <- merge(endpts, wj_scores_df)
View(endpts)
nrow(endpts)
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
View(endpts)
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$type), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$contrast), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
summary(lmfit)
coefs <- data.frame(coef(summary(lmfit)))
df.KR <- get_ddf_Lb(lmfit, fixef(lmfit))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
lmfit <- lmer(correct ~ trial + wj_brs + paradigm + adhd_dx + age + (1|subject_id), endpts)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm + (1|subject_id), endpts)
lmfit_no_adhd <- update(lmfit, ~ . - adhd_dx)
anova(lmfit, lmfit_no_adhd) #OK to remove adhd
rm(list = ls())
library(ggplot2)
library(dplyr)
library(stringr)
library(lme4)
library(dplyr)
library(pbkrtest)
use_df <- read.csv("./cleaned_data.csv")
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts$correct <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$type), "ABX"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$paradigm), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$continuum), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age_at_testing, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
View(endpts)
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
use_df <- read.csv("./cleaned_data.csv")
endpts <- use_df %>%
#filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, paradigm)
endpts <- mutate(endpts, correct = ifelse(step == 1 & response == 0, "1",
ifelse( step == 7 & response == 1, "1", "0")))
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$paradigm), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$continuum), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age_at_testing, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
endpts$correct <- as.numeric(endpts$correct)
endpts$paradigm <- factor(endpts$paradigm, levels=c("Single", "ABX"))
endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$paradigm), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$continuum), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age_at_testing, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
summary(lmfit)
endpts$trial <- scale(endpts$trial, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
summary(lmfit)
coefs <- data.frame(coef(summary(lmfit)))
df.KR <- get_ddf_Lb(lmfit, fixef(lmfit))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
lmfit <- lmer(correct ~ trial + wj_brs + paradigm + adhd_dx + age + (1|subject_id), endpts)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm + (1|subject_id), endpts)
lmfit_no_adhd <- update(lmfit, ~ . - adhd_dx)
anova(lmfit, lmfit_no_adhd) #OK to remove adhd
lmfit_no_age <- update(lmfit, ~ . - age)
anova(lmfit, lmfit_no_age) #OK to remove age
lmfit_no_nuisance <- update(lmfit, ~ . - age -adhd_dx)
anova(lmfit, lmfit_no_nuisance) #OK to remove adhd and age
summary(lmfit_no_nuisance)
coefs <- data.frame(coef(summary(lmfit_no_nuisance)))
df.KR <- get_ddf_Lb(lmfit_no_nuisance, fixef(lmfit_no_nuisance))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
lmfit_no_paradigm <- lmer(correct ~ trial*wj_brs*continuum  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_paradigm) # OK to remove paradigm
lmfit_no_continuum <- lmer(correct ~ trial*wj_brs*paradigm  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_continuum) # OK to remove continuum
anova(lmfit_no_nuisance, lmfit_no_paradigm) # not OK to remove paradigm
lmfit_no_paradigm <- lmer(correct ~ trial*wj_brs*continuum  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_paradigm) # not OK to remove paradigm
lmfit_no_continuum <- lmer(correct ~ trial*wj_brs*paradigm  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_continuum) # OK to remove continuum
lmfit_no_cont_or_cond <- lmer(correct ~ trial*wj_brs  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_cont_or_cond) # OK to remove continuum and paradigm
lmfit_no_paradigm <- lmer(correct ~ trial*wj_brs*continuum  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_paradigm) # not OK to remove paradigm
lmfit_no_continuum <- lmer(correct ~ trial*wj_brs*paradigm  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_continuum) # OK to remove continuum
lmfit_no_cont_or_cond <- lmer(correct ~ trial*wj_brs  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_cont_or_cond) # OK to remove continuum and paradigm
lmfit_no_interaction <- lmer(correct ~ trial + wj_brs + (1|subject_id), endpts)
anova(lmfit_no_cont_or_cond, lmfit_no_interaction) # OK to remove interaction of WJ and trial
anova(lmfit_no_continuum, lmfit_no_interaction) # OK to remove interaction of WJ and trial
lmfit_no_continuum <- lmer(correct ~ trial*wj_brs*paradigm  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_continuum) # OK to remove continuum
summary(lmfit_no_continuum)
coefs <- data.frame(coef(summary(lmfit_no_continuum)))
df.KR <- get_ddf_Lb(lmfit_no_continuum, fixef(lmfit_no_continuum))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
lmfit_no_continuum <- lmer(correct ~ trial*wj_brs*paradigm  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_continuum) # OK to remove continuum
lmfit_no_cont_or_cond <- lmer(correct ~ trial*wj_brs  +  (1|subject_id), endpts)
anova(lmfit_no_nuisance, lmfit_no_cont_or_cond) # OK to remove continuum and paradigm
lmfit_no_interaction_wjtrial <- lmer(correct ~ trial + wj_brs + paradigm + trial:paradigm + wj_brs:paradigm + trial:paradigm:wj_brs + (1|subject_id), endpts)
anova(lmfit_no_continuum, lmfit_no_interaction_wjtrial)
lmfit_no_interaction_trialpara <- lmer(correct ~ trial + wj_brs + paradigm + wj_brs:trial+ wj_brs:paradigm + trial:paradigm:wj_brs + (1|subject_id), endpts)
anova(lmfit_no_continuum, lmfit_no_interaction_trialparal) #Not ok to remove wj:trial
anova(lmfit_no_continuum, lmfit_no_interaction_trialpara) #Not ok to remove wj:trial
lmfit_no_interaction_three <- lmer(correct ~ trial + wj_brs + paradigm + wj_brs:trial+ wj_brs:paradigm + (1|subject_id), endpts)
anova(lmfit_no_interaction_trialpara, lmfit_no_interaction_three) #OK to remove paradigm:trial int
lmfit_no_main_para <- lmer(correct ~ trial + wj_brs + wj_brs:trial+ wj_brs:paradigm + (1|subject_id), endpts)
anova(lmfit_no_interaction_three, lmfit_no_mainpara) #OK to remove paradigm:trial:wj interaction
anova(lmfit_no_interaction_three, lmfit_no_main_para) #OK to remove paradigm:trial:wj interaction
summary(lmfit_no_main_para)
coefs <- data.frame(coef(summary(lmfit_no_main_para)))
df.KR <- get_ddf_Lb(lmfit_no_main_para, fixef(lmfit_no_main_para))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
lmfit_no_trialwj <- lmer(correct ~ trial + wj_brs +wj_brs:paradigm + (1|subject_id), endpts)
anova(lmfit_no_main_para, lmfit_no_trialwj) #OK to remove main effect of paradigm
summary(lmfit_no_trialwj)
coefs <- data.frame(coef(summary(lmfit_no_trialwj)))
df.KR <- get_ddf_Lb(lmfit_no_trialwj, fixef(lmfit_no_trialwj))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
rm(list = ls())
