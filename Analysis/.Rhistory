endpts$continuum <- factor(endpts$continuum,
levels=c("/ba/-/da/", "/ʃa/-/sa/"))
contrasts(endpts$paradigm) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$type), "ABX"))
contrasts(endpts$continuum) <- matrix(c(-0.5, 0.5), nrow=2,
dimnames=list(levels(endpts$contrast), "/ʃa/-/sa/"))
endpts$adhd_dx <- as.logical(endpts$adhd_dx)
endpts$wj_brs <- scale(endpts$wj_brs, scale=FALSE)
endpts$age <- scale(endpts$age, scale=FALSE)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm*continuum + adhd_dx + age +  (1|subject_id), endpts)
summary(lmfit)
coefs <- data.frame(coef(summary(lmfit)))
df.KR <- get_ddf_Lb(lmfit, fixef(lmfit))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
lmfit <- lmer(correct ~ trial + wj_brs + paradigm + adhd_dx + age + (1|subject_id), endpts)
lmfit <- lmer(correct ~ trial*wj_brs*paradigm + (1|subject_id), endpts)
lmfit_no_adhd <- update(lmfit, ~ . - adhd_dx)
anova(lmfit, lmfit_no_adhd) #OK to remove adhd
lmfit_no_age <- update(lmfit, ~ . - age)
anova(lmfit, lmfit_no_age) #OK to remove age
lmfit_no_nuisance <- update(lmfit, ~ . - age -adhd_dx)
anova(lmfit, lmfit_no_nuisance) #OK to remove adhd and age
summary(lmfit_no_nuisance)
coefs <- data.frame(coef(summary(lmfit_no_nuisance)))
df.KR <- get_ddf_Lb(lmfit_no_nuisance, fixef(lmfit_no_nuisance))
coefs$p.KR <- 2*(1-pt(abs(coefs$t.value), df.KR))
coefs
library(ggplot2)
library(dplyr)
library(data.table)
library(tidyr)
file_list = list.files(path = "/home/eobrien/bde/Projects/Speech_contrasts/Results/Psychometrics/Raw")
file_str = str_extract_all(file_list, "[A-Za-z0-9]+")
subj_id <- character(length(file_list))
for (i in 1:length(file_list)){
subj_id[i] <- file_str[[i]][4]
}
subj_id_list = unique(subj_id)
cont <- "Sa_Sha"
ba_da_pm <- data.frame()
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
#  file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
cont = "Ba_Da"
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
filepath = '/home/eobrien/bde/Projects/Speech_contrasts/'
repos_df <- read.csv( paste0(filepath, "RDRPRepository_DATA_2018-02-12_1433.csv"))
registry_df<- read.csv( paste0(filepath, "RDRPRegistry_DATA_2018-01-02_1138.csv"))
colnames(repos_df)[1] <- "record_id"
master_df <- merge(repos_df, registry_df, by = "record_id")
subj_record_id <- master_df %>% filter(sid.x %in% subj_id_list) %>% select(record_id)
subject_df <- master_df %>% filter(record_id %in% subj_record_id$record_id)
reading_df <- subject_df[c("record_id","dys_dx","adhd_dx","brain_injury","aud_dis","wj_brs","twre_index","wasi_fs2")]
reading_df <- reading_df[!duplicated(reading_df),]
reading_df <- reading_df %>% group_by(record_id) %>% summarise_all(funs(mean(as.numeric(.), na.rm=TRUE)))
bio_df <- subject_df[c("sid.x","dob","record_id")]
bio_df[bio_df==""] <- NA
bio_df <- na.omit(bio_df)
timestamp = numeric(length(subj_id_list))
for (i in 1:length(subj_id_list)){
con <- file(paste0(filepath, "Results/Raw/", subj_id_list[i], "_categorization_Ba_Da_1.txt"))
timestamp[i] <- readLines(con,n=1)
close(con)
}
timestamp_df = data.frame(psych_date = timestamp,
sid.x = subj_id_list)
vars <- colsplit(timestamp_df$psych_date, ",", c("date","time"))
timestamp_df$psych_date <- vars$date
bio_df <- merge(bio_df, timestamp_df)
bio_df$dob <- as.POSIXct(bio_df$dob, format="%Y-%m-%d")
bio_df$psych_date <- as.POSIXct(bio_df$psych_date, format="%Y-%m-%d")
bio_df$age_at_testing <- as.numeric(difftime(bio_df$psych_date,bio_df$dob,units="weeks")/52.25)
colnames(bio_df)[1] <- "subject_id"
master_df <- merge(bio_df, ba_da_pm)
master_df <- merge(master_df, reading_df)
use_df <- subset(master_df, psych_date >= "2017-08-15")
use_df <- subset(use_df, age_at_testing >= 8 & age_at_testing < 13)
use_df <- subset(use_df, aud_dis == 0)
use_df <- subset(use_df, wasi_fs2 >= 70)
use_df <- subset(use_df, !(subject_id %in% c("IB701","KB630","IB706","IB263","HB656","HB213","IB319","HB742","GB727")))
use_df <- mutate(use_df, is_dyslexic = ifelse( (wj_brs <= 85 & twre_index <= 85) | subject_id == "HB664","dyslexic",
ifelse((wj_brs >= 100 & twre_index >= 100) , "above average", "below average")))
library(stringr)
library(dplyr)
library(lme4)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
endpts_sasha <- use_df %>%
filter(str_detect(stimulus, "Sa")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition ) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Sha", "1",
ifelse(str_detect(stimulus,"7") & selection == "Sa", "1",
"0")),
continuum = "/ʃa/-/sa/")
endpts <- rbind(endpts_bada, endpts_sasha)
View(endpts_sasha)
20*6*44
length(unique(run_id))
length(unique(endpts$run_id))
unique(endpts$run_id)
endpts$id2 <- paste0(endpts$run_id, "_", endpts$continuum)
View(endpts)
length(unique(endtps$id2))
length(unique(endpts$id2))
unique(endpts$id2)
6*44
file_list = list.files(path = "/home/eobrien/bde/Projects/Speech_contrasts/Results/Psychometrics/Raw")
file_str = str_extract_all(file_list, "[A-Za-z0-9]+")
subj_id <- character(length(file_list))
for (i in 1:length(file_list)){
subj_id[i] <- file_str[[i]][4]
}
subj_id_list = unique(subj_id)
cont <- "Sa_Sha"
ba_da_pm <- data.frame()
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
#  file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
warnings()
rm(list = ls())
_
_
file_list = list.files(path = "/home/eobrien/bde/Projects/Speech_contrasts/Results/Psychometrics/Raw")
file_str = str_extract_all(file_list, "[A-Za-z0-9]+")
subj_id <- character(length(file_list))
for (i in 1:length(file_list)){
subj_id[i] <- file_str[[i]][4]
}
subj_id_list = unique(subj_id)
cont <- "Sa_Sha"
ba_da_pm <- data.frame()
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
#  file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
View(ba_da_pm)
ba_da_pm <- data.frame()
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
#  file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
cont <- "Sa_Sha"
ba_da_pm <- data.frame()
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
#  file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
View(df_tmp)
es <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
View(df_tmp)
cont <- "Sa_Sha"
ba_da_pm <- data.frame()
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
#  file_name = paste0("P:\\bde\\Projects\\Speech_contrasts\\Results\\Raw\\", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', df_tmp$sound2, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({#file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
cont = "Ba_Da"
for (i in 1:44){
file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_1.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)
res <-try({file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_2.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
res <-try({file_name = paste0("/home/eobrien/bde/Projects/Speech_contrasts/Results/Raw/", subj_id_list[i],"_categorization_",cont,"_3.txt")
df_tmp <- fread(file_name)
df_tmp$subject_id <- subj_id_list[i]
if(is.na(unique(df_tmp$sound2))){
df_tmp$Condition = "Single"
} else{df_tmp$Condition = "ABX" }
df_tmp$run_id <- paste0(df_tmp$subject_id, '_', cont, '_', df_tmp$Condition)
ba_da_pm <- rbind(ba_da_pm, df_tmp)})
if (inherits(res, "try-error"))
{continue = TRUE}
}
filepath = '/home/eobrien/bde/Projects/Speech_contrasts/'
repos_df <- read.csv( paste0(filepath, "RDRPRepository_DATA_2018-02-12_1433.csv"))
registry_df<- read.csv( paste0(filepath, "RDRPRegistry_DATA_2018-01-02_1138.csv"))
colnames(repos_df)[1] <- "record_id"
master_df <- merge(repos_df, registry_df, by = "record_id")
subj_record_id <- master_df %>% filter(sid.x %in% subj_id_list) %>% select(record_id)
subject_df <- master_df %>% filter(record_id %in% subj_record_id$record_id)
reading_df <- subject_df[c("record_id","dys_dx","adhd_dx","brain_injury","aud_dis","wj_brs","twre_index","wasi_fs2")]
reading_df <- reading_df[!duplicated(reading_df),]
reading_df <- reading_df %>% group_by(record_id) %>% summarise_all(funs(mean(as.numeric(.), na.rm=TRUE)))
bio_df <- subject_df[c("sid.x","dob","record_id")]
bio_df[bio_df==""] <- NA
bio_df <- na.omit(bio_df)
timestamp = numeric(length(subj_id_list))
for (i in 1:length(subj_id_list)){
con <- file(paste0(filepath, "Results/Raw/", subj_id_list[i], "_categorization_Ba_Da_1.txt"))
timestamp[i] <- readLines(con,n=1)
close(con)
}
timestamp_df = data.frame(psych_date = timestamp,
sid.x = subj_id_list)
vars <- colsplit(timestamp_df$psych_date, ",", c("date","time"))
timestamp_df$psych_date <- vars$date
bio_df <- merge(bio_df, timestamp_df)
bio_df$dob <- as.POSIXct(bio_df$dob, format="%Y-%m-%d")
bio_df$psych_date <- as.POSIXct(bio_df$psych_date, format="%Y-%m-%d")
bio_df$age_at_testing <- as.numeric(difftime(bio_df$psych_date,bio_df$dob,units="weeks")/52.25)
colnames(bio_df)[1] <- "subject_id"
master_df <- merge(bio_df, ba_da_pm)
master_df <- merge(master_df, reading_df)
use_df <- subset(master_df, psych_date >= "2017-08-15")
use_df <- subset(use_df, age_at_testing >= 8 & age_at_testing < 13)
use_df <- subset(use_df, aud_dis == 0)
use_df <- subset(use_df, wasi_fs2 >= 70)
use_df <- subset(use_df, !(subject_id %in% c("IB701","KB630","IB706","IB263","HB656","HB213","IB319","HB742","GB727")))
use_df <- mutate(use_df, is_dyslexic = ifelse( (wj_brs <= 85 & twre_index <= 85) | subject_id == "HB664","dyslexic",
ifelse((wj_brs >= 100 & twre_index >= 100) , "above average", "below average")))
library(stringr)
library(dplyr)
library(lme4)
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
endpts_sasha <- use_df %>%
filter(str_detect(stimulus, "Sa")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition ) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Sha", "1",
ifelse(str_detect(stimulus,"7") & selection == "Sa", "1",
"0")),
continuum = "/ʃa/-/sa/")
endpts_bada <- use_df %>%
filter(str_detect(stimulus, "Ba")) %>%
subset(str_detect(stimulus,"1")| str_detect(stimulus,"7")) %>%
group_by(run_id, stimulus, trial, Condition) %>%
summarise(selection = unique(selection),
subject_id = unique(subject_id),
is_dyslexic = unique(is_dyslexic)) %>%
mutate(correct = ifelse(str_detect(stimulus,"1") & selection == "Ba", "1",
ifelse(str_detect(stimulus,"7") & selection == "Da", "1",
"0")),
continuum ="/ba/-/da/")
